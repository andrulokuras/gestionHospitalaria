<!-- Parte de la estructura de esta vista, incluyendo el formulario de búsqueda 
     de pacientes, la tabla de resultados y la navegación hacia el expediente 
     clínico individual, fue generada y asistida mediante ChatGPT (OpenAI, 
     versión GPT-5.1).
     
     El código fue posteriormente revisado y adaptado por el estudiante para 
     integrarse con el módulo de historial clínico del sistema y facilitar la 
     selección de pacientes de manera clara y eficiente. -->
{% extends "base.html" %}
{% block title %}Selección de Paciente{% endblock %}

{% block content %}
<h2>Historial Clínico - Selección de Paciente</h2>
<div class="card mt-3">
    <div class="card-body">
                <!-- Filtro de búsqueda por nombre -->
        <form method="GET" action="{{ url_for('lista_historial') }}" class="row g-2 mb-3">
            <div class="col-md-8">
                <label class="form-label">Buscar paciente por nombre</label>
                <input
                    type="text"
                    name="buscar_nombre"
                    class="form-control"
                    placeholder="Ej. Juan Pérez"
                    value="{{ filtro_nombre or '' }}"
                >
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <button type="submit" class="btn btn-secondary w-100">
                    Buscar
                </button>
            </div>
        </form>

        <table class="table table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Seguro Médico</th>
                    <th>Acción</th>
                </tr>
            </thead>
            <tbody>
                {% for p in pacientes %}
                <tr>
                    <td>{{ p.id_paciente }}</td>
                    <td>{{ p.nombre_completo }}</td>
                    <td>{{ p.seguro_medico }}</td>
                    <td>
                        <a href="{{ url_for('ver_expediente', id_paciente=p.id_paciente) }}" 
                           class="btn btn-info text-white">
                           <i class="bi bi-eye-fill"></i> Ver Expediente
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
